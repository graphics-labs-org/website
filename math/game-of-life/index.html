<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Automata | Graphics Labs</title>
    <meta name="description" content="Simulaci√≥n del Juego de la Vida de Conway. Aut√≥matas celulares.">
    <style>
        /* --- ESTILOS BASE --- */
        :root {
            --primary: #00ff41; 
            --primary-dim: rgba(0, 255, 65, 0.3);
            --secondary: #bd00ff;
            --highlight: #ffee00;
            --glass: rgba(20, 20, 20, 0.7);
            --glass-text: rgba(30, 30, 30, 0.8);
            --border: rgba(255, 255, 255, 0.1);
            --text: #ffffff;
            --muted: #aaaaaa;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', monospace, sans-serif; }
        
        body {
            background-color: #050505;
            color: var(--text);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            user-select: none;
        }

        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }

        .container {
            position: relative;
            z-index: 10;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* --- CONTROLES --- */
        .controls {
            background: var(--glass);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin: 20px auto;
            width: 100%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .control-row { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; width: 100%; align-items: center; }

        button.action-btn {
            background: var(--primary); color: #000; border: none; padding: 10px 20px; border-radius: 5px;
            cursor: pointer; font-weight: bold; transition: 0.3s; text-transform: uppercase; font-size: 0.9rem;
            min-width: 120px;
        }
        button.action-btn:hover { box-shadow: 0 0 15px var(--primary); transform: scale(1.05); }
        
        button.secondary-btn {
            background: transparent; border: 1px solid var(--secondary); color: var(--secondary);
            padding: 8px 15px; border-radius: 5px; cursor: pointer; transition: 0.3s; font-size: 0.9rem;
        }
        button.secondary-btn:hover { background: var(--secondary); color: #fff; box-shadow: 0 0 15px var(--secondary); }
        
        button.secondary-btn.active-mode {
            background: var(--secondary); color: #fff; box-shadow: 0 0 10px var(--secondary);
        }

        /* Sliders y Selects MEJORADOS */
        .input-group { display: flex; align-items: center; gap: 10px; color: var(--muted); font-size: 0.9rem; }
        
        select {
            background: rgba(0,0,0,0.5); color: var(--text); border: 1px solid var(--border);
            padding: 5px 10px; border-radius: 4px; outline: none; cursor: pointer;
        }
        select:hover { border-color: var(--primary); }

        input[type="range"] {
            -webkit-appearance: none; background: transparent; width: 120px; /* Un poco m√°s ancho */
        }
        
        /* Pista del slider m√°s visible */
        input[type="range"]::-webkit-slider-runnable-track {
            width: 100%; height: 6px; cursor: pointer; 
            background: rgba(255, 255, 255, 0.2); /* M√°s visible */
            border: 1px solid rgba(255, 255, 255, 0.1); /* Borde sutil */
            border-radius: 5px;
        }
        
        /* Thumb (el bot√≥n que se mueve) */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
            background: var(--primary); cursor: pointer; margin-top: -6px; /* Centrado vertical */
            box-shadow: 0 0 8px var(--primary); border: 2px solid #000;
        }

        /* --- VISUALIZADOR --- */
        #canvas-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            margin-bottom: 20px;
            position: relative;
        }

        #life-canvas {
            background: #000;
            border: 1px solid var(--border);
            border-radius: 4px;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.1);
            cursor: crosshair;
            image-rendering: pixelated; 
        }

        /* --- BARRA DE ESTADO (GRID PARA EVITAR SALTOS) --- */
        .status-container {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr; /* 3 columnas: Gen, Patr√≥n (m√°s ancho), Poblaci√≥n */
            width: 100%;
            max-width: 800px;
            margin-top: 15px;
            border-top: 1px solid var(--border);
            padding-top: 10px;
        }

        .status-item {
            color: var(--highlight);
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            letter-spacing: 1px;
            text-align: center;
        }
        
        /* En pantallas muy peque√±as, apilar */
        @media (max-width: 600px) {
            .status-container { grid-template-columns: 1fr; gap: 5px; }
        }

        /* --- INFO --- */
        .info-section {
            background: var(--glass-text);
            padding: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin: 40px auto;
            max-width: 900px;
            text-align: left;
            line-height: 1.8;
            color: #ddd;
        }
        .info-section h2 { color: var(--primary); margin-bottom: 20px; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-top: 40px; }
        .info-section h2:first-child { margin-top: 0; }
        .info-section p { margin-bottom: 20px; font-size: 1rem; text-align: justify; }
        
        .rules-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;
        }
        .rule-card {
            background: rgba(0,0,0,0.3); border: 1px solid var(--border); padding: 15px; border-radius: 8px; text-align: center;
        }
        .rule-icon { font-size: 2rem; margin-bottom: 10px; display: block; }
        .rule-text { font-size: 0.9rem; color: var(--muted); }

        .math-box {
            background: rgba(0,0,0,0.5); border-left: 4px solid var(--secondary);
            padding: 20px; margin: 20px 0; font-family: 'Courier New', monospace;
            color: var(--secondary); font-size: 1rem; text-align: center;
        }

        .ad-container {
            width: 100%; max-width: 728px; margin: 30px auto; min-height: 90px;
            display: flex; justify-content: center; align-items: center;
            border: 1px dashed rgba(255,255,255,0.1); border-radius: 8px; background: rgba(0,0,0,0.2);
        }
        .ad-placeholder-text { color: var(--border); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; }

        /* Nav & Footer */
        nav { display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .nav-links { display: flex; gap: 15px; }
        .nav-btn { text-decoration: none; color: var(--muted); font-size: 0.9rem; border: 1px solid var(--border); padding: 5px 10px; border-radius: 4px; transition: 0.3s; background: rgba(0,0,0,0.5); }
        .nav-btn:hover { color: var(--primary); border-color: var(--primary); }
        .logo { font-size: 1.2rem; font-weight: bold; color: var(--primary); text-decoration: none; letter-spacing: 2px; }
        .lang-switch button { background: rgba(0,0,0,0.5); border: 1px solid var(--border); color: var(--muted); padding: 5px 10px; cursor: pointer; border-radius: 4px; margin-left: 2px;}
        .lang-switch button.active { background-color: var(--primary) !important; color: #000 !important; border-color: var(--primary) !important; font-weight: bold; }
        footer { margin-top: auto; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); border-top: 1px solid var(--border); padding: 30px 20px; text-align: center; font-size: 0.8rem; color: var(--muted); display: flex; flex-direction: column; gap: 15px; align-items: center; position: relative; z-index: 20; }
        .legal-links { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; margin-bottom: 10px; }
        .legal-links a { color: var(--muted); text-decoration: none; transition: 0.3s; border-bottom: 1px solid transparent; }
        .legal-links a:hover { color: var(--primary); border-bottom-color: var(--primary); }
        .coffee-btn { background: linear-gradient(45deg, #FFDD00, #FBB03B); color: #000; padding: 8px 15px; border-radius: 20px; text-decoration: none; font-weight: bold; font-size: 0.85rem; display: inline-flex; align-items: center; gap: 5px; transition: transform 0.2s; }
        .coffee-btn:hover { transform: scale(1.05); }

    </style>
</head>
<body oncontextmenu="return false;">

    <canvas id="bg-canvas"></canvas>

    <div class="container">
        <nav>
            <div class="nav-links">
                <a href="../../index.html" class="nav-btn" id="nav-main">‚Üê HUB PRINCIPAL</a>
                <a href="../index.html" class="nav-btn" id="nav-math">‚Üê HUB MATH</a>
            </div>
            <div class="logo">GRAPHICS LABS</div>
            <div class="lang-switch">
                <button onclick="setLang('es')" id="btn-es" class="active">ES</button>
                <button onclick="setLang('ca')" id="btn-ca">CA</button>
                <button onclick="setLang('en')" id="btn-en">EN</button>
                <button onclick="setLang('fr')" id="btn-fr">FR</button>
                <button onclick="setLang('de')" id="btn-de">DE</button>
                <button onclick="setLang('pt')" id="btn-pt">PT</button>
                <button onclick="setLang('it')" id="btn-it">IT</button>
                <button onclick="setLang('nl')" id="btn-nl">NL</button>
                <button onclick="setLang('ja')" id="btn-ja">JP</button>
            </div>
        </nav>

        <h1 id="txt-title">PROYECTO AUT√ìMATA</h1>
        <p style="color:var(--muted); margin-bottom: 20px;" id="txt-desc">El Juego de la Vida de Conway. Emergencia matem√°tica.</p>

        <div class="controls">
            <div class="control-row">
                <button class="action-btn" onclick="togglePlay()" id="btn-play">‚ñ∂ PLAY</button>
                <button class="secondary-btn" onclick="clearGrid()" id="btn-clear">LIMPIAR</button>
                <button class="secondary-btn" onclick="randomizeGrid()" id="btn-random">RANDOM</button>
            </div>
            
            <div class="control-row">
                <button class="secondary-btn" onclick="toggleColorMode()" id="btn-color">üé® COLOR</button>
                <button class="secondary-btn" onclick="saveImage()" id="btn-save">üíæ IMG</button>
                
                <div class="input-group">
                    <span id="lbl-speed">Velocidad:</span>
                    <input type="range" id="speed-slider" min="1" max="60" value="30">
                </div>
            </div>

            <div class="control-row">
                <div class="input-group">
                    <span id="lbl-pattern">Patr√≥n:</span>
                    <select id="pattern-select" onchange="loadPattern(this.value, this.options[this.selectedIndex].text)">
                        <option value="none" id="opt-select">- Seleccionar -</option>
                        <option value="glider">Glider</option>
                        <option value="gosper">Gosper Glider Gun</option>
                        <option value="pulsar">Pulsar (Period 3)</option>
                        <option value="lwss">Nave Ligera (LWSS)</option>
                    </select>
                </div>
            </div>

            <div class="status-container">
                <div class="status-item" id="stat-gen-display">GEN: 0</div>
                <div class="status-item" id="stat-pat-display">PATR√ìN: CUSTOM</div>
                <div class="status-item" id="stat-pop-display">POBLACI√ìN: 0</div>
            </div>
        </div>

        <div id="canvas-container">
            <canvas id="life-canvas"></canvas>
            <p style="color:var(--muted); font-size: 0.8rem; margin-top:5px;" id="txt-note">Haz clic o arrastra el mouse sobre la rejilla para dar vida a las c√©lulas.</p>
        </div>

        <div class="info-section">
            <h2 id="info-h-what">¬øQu√© es el Juego de la Vida?</h2>
            <p id="info-p-what">
                Dise√±ado por el matem√°tico brit√°nico John Horton Conway en 1970, no es un juego en el sentido tradicional. Es un "juego de cero jugadores" o aut√≥mata celular. T√∫ determinas el estado inicial (la semilla) y luego observas c√≥mo evoluciona el sistema sin ninguna intervenci√≥n m√°s, siguiendo reglas deterministas estrictas. A pesar de la simplicidad de estas reglas, el sistema es capaz de generar patrones impredecibles, ca√≥ticos e incluso computacionales.
            </p>

            <h2 id="info-h-rules">Las 4 Reglas Sagradas</h2>
            <p id="info-p-rules">
                El universo es una rejilla infinita de celdas cuadradas. Cada celda tiene dos estados posibles: viva o muerta. En cada paso de tiempo (generaci√≥n), cada celda interact√∫a con sus 8 vecinas:
            </p>

            <div class="rules-grid">
                <div class="rule-card">
                    <span class="rule-icon">üíÄ</span>
                    <p class="rule-text" id="rule-1"><strong>Soledad:</strong> Una c√©lula viva con menos de 2 vecinas muere.</p>
                </div>
                <div class="rule-card">
                    <span class="rule-icon">üíö</span>
                    <p class="rule-text" id="rule-2"><strong>Supervivencia:</strong> Una c√©lula viva con 2 o 3 vecinas sigue viva.</p>
                </div>
                <div class="rule-card">
                    <span class="rule-icon">üíÄ</span>
                    <p class="rule-text" id="rule-3"><strong>Sobrepoblaci√≥n:</strong> Una c√©lula viva con m√°s de 3 vecinas muere.</p>
                </div>
                <div class="rule-card">
                    <span class="rule-icon">‚ú®</span>
                    <p class="rule-text" id="rule-4"><strong>Reproducci√≥n:</strong> Una c√©lula muerta con exactamente 3 vecinas nace.</p>
                </div>
            </div>

            <h2 id="info-h-math">Significado Matem√°tico</h2>
            <p id="info-p-math">
                Este aut√≥mata es un ejemplo cl√°sico de <strong>Emergencia</strong>: c√≥mo la complejidad surge de la simplicidad. Matem√°ticamente, el Juego de la Vida es <strong>Turing Completo</strong>. Esto significa que, con una rejilla lo suficientemente grande y tiempo suficiente, se puede construir una m√°quina dentro del juego capaz de calcular cualquier algoritmo que una computadora moderna pueda ejecutar.
            </p>

            <div class="math-box">
                Estado(t+1) = f(Estado(t), Vecinos)
            </div>
        </div>

        <div class="ad-container"><span class="ad-placeholder-text">Ad Space</span></div>
    </div>

    <footer>
        <div class="legal-links">
            <a href="../../legal.html" id="link-legal">Aviso Legal</a>
            <a href="../../privacy.html" id="link-privacy">Pol√≠tica de Privacidad</a>
            <a href="../../cookies.html" id="link-cookies">Pol√≠tica de Cookies</a>
            <a href="mailto:pbazan@gmail.com" id="link-contact">Contacto</a>
        </div>
        <span id="footer-rights">¬© 2025 Graphics Labs</span>
        <a href="https://paypal.me/pbazan" target="_blank" class="coffee-btn">
            ‚òï <span id="btn-coffee">Inv√≠tame a un caf√©</span>
        </a>
    </footer>

    <script>
        /* --- 1. CONFIGURACI√ìN DEL JUEGO --- */
        const canvas = document.getElementById('life-canvas');
        const ctx = canvas.getContext('2d');
        
        // Elementos de estado por separado
        const displayGen = document.getElementById('stat-gen-display');
        const displayPat = document.getElementById('stat-pat-display');
        const displayPop = document.getElementById('stat-pop-display');
        
        let resolution = 10; 
        let cols, rows;
        let grid;
        let animationId;
        let isPlaying = false;
        let generation = 0;
        let population = 0;
        let speed = 30;
        let lastFrameTime = 0;
        
        let isColorMode = false;
        let currentPatternName = "CUSTOM";

        function resizeCanvas() {
            const maxWidth = Math.min(window.innerWidth - 40, 800);
            const height = 500;
            
            canvas.width = Math.floor(maxWidth / resolution) * resolution;
            canvas.height = Math.floor(height / resolution) * resolution;
            
            cols = canvas.width / resolution;
            rows = canvas.height / resolution;
            
            grid = make2DArray(cols, rows);
            draw();
        }

        function make2DArray(c, r) {
            let arr = new Array(c);
            for (let i = 0; i < arr.length; i++) {
                arr[i] = new Array(r).fill(0);
            }
            return arr;
        }

        /* --- 2. L√ìGICA DEL CORE --- */
        function computeNextGen() {
            let next = make2DArray(cols, rows);
            population = 0;

            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    let state = grid[i][j];
                    let neighbors = countNeighbors(grid, i, j);

                    if (state == 0 && neighbors == 3) {
                        next[i][j] = 1; 
                    } else if (state == 1 && (neighbors < 2 || neighbors > 3)) {
                        next[i][j] = 0;
                    } else {
                        next[i][j] = state; 
                    }

                    if(next[i][j] === 1) population++;
                }
            }
            grid = next;
            generation++;
            updateStatus();
        }

        function countNeighbors(grid, x, y) {
            let sum = 0;
            for (let i = -1; i < 2; i++) {
                for (let j = -1; j < 2; j++) {
                    let col = (x + i + cols) % cols;
                    let row = (y + j + rows) % rows;
                    sum += grid[col][row];
                }
            }
            sum -= grid[x][y]; 
            return sum;
        }

        function draw() {
            ctx.fillStyle = '#000'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Rejilla
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            for (let i = 0; i <= cols; i++) {
                ctx.moveTo(i * resolution, 0); ctx.lineTo(i * resolution, canvas.height);
            }
            for (let j = 0; j <= rows; j++) {
                ctx.moveTo(0, j * resolution); ctx.lineTo(canvas.width, j * resolution);
            }
            ctx.stroke();

            // C√©lulas
            ctx.shadowBlur = isColorMode ? 15 : 10; 

            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    if (grid[i][j] == 1) {
                        if (isColorMode) {
                            const hue = (generation * 2 + (i * 3) + (j * 3)) % 360;
                            const color = `hsl(${hue}, 100%, 50%)`;
                            ctx.fillStyle = color;
                            ctx.shadowColor = color;
                        } else {
                            ctx.fillStyle = '#00f341'; 
                            ctx.shadowColor = '#00f341';
                        }
                        ctx.fillRect(i * resolution + 1, j * resolution + 1, resolution - 1, resolution - 1);
                    }
                }
            }
            ctx.shadowBlur = 0; 
        }

        /* --- 3. GAME LOOP --- */
        function gameLoop(timestamp) {
            if (!isPlaying) return;

            const interval = 1000 / speed;
            if (timestamp - lastFrameTime > interval) {
                computeNextGen();
                draw();
                lastFrameTime = timestamp;
            }
            
            animationId = requestAnimationFrame(gameLoop);
        }

        /* --- 4. CONTROLES DE USUARIO --- */
        function togglePlay() {
            isPlaying = !isPlaying;
            const btn = document.getElementById('btn-play');
            
            if (isPlaying) {
                btn.innerText = "‚è∏ PAUSE";
                btn.style.background = "var(--secondary)"; 
                btn.style.color = "#fff";
                gameLoop(0);
            } else {
                btn.innerText = "‚ñ∂ PLAY";
                btn.style.background = "var(--primary)";
                btn.style.color = "#000";
                cancelAnimationFrame(animationId);
            }
        }

        function clearGrid() {
            grid = make2DArray(cols, rows);
            generation = 0;
            population = 0;
            currentPatternName = "CUSTOM";
            
            isPlaying = false;
            document.getElementById('btn-play').innerText = "‚ñ∂ PLAY";
            document.getElementById('btn-play').style.background = "var(--primary)";
            
            draw();
            updateStatus();
        }

        function randomizeGrid() {
            population = 0;
            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    const alive = Math.random() > 0.85 ? 1 : 0;
                    grid[i][j] = alive;
                    if(alive) population++;
                }
            }
            generation = 0;
            currentPatternName = "RANDOM";
            draw();
            updateStatus();
        }

        function toggleColorMode() {
            isColorMode = !isColorMode;
            const btn = document.getElementById('btn-color');
            if(isColorMode) {
                btn.classList.add('active-mode');
            } else {
                btn.classList.remove('active-mode');
            }
            draw();
        }

        function saveImage() {
            const link = document.createElement('a');
            link.download = 'game_of_life_' + generation + '.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // Mouse interaction
        let isDrawing = false;
        
        function paintCell(e) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const i = Math.floor(x / resolution);
            const j = Math.floor(y / resolution);
            
            if (i >= 0 && i < cols && j >= 0 && j < rows) {
                if(grid[i][j] === 0) {
                    grid[i][j] = 1;
                    population++;
                    
                    // --- CORRECCI√ìN SOLICITADA ---
                    // Al pintar, cambiamos el nombre a "PERSONALIZADO" (o su traducci√≥n)
                    currentPatternName = "CUSTOM"; 
                    
                    updateStatus();
                    draw();
                }
            }
        }

        canvas.addEventListener('mousedown', (e) => { isDrawing = true; paintCell(e); });
        canvas.addEventListener('mousemove', (e) => { if(isDrawing) paintCell(e); });
        canvas.addEventListener('mouseup', () => { isDrawing = false; });
        canvas.addEventListener('mouseleave', () => { isDrawing = false; });

        document.getElementById('speed-slider').addEventListener('input', (e) => {
            speed = parseInt(e.target.value);
        });

        /* --- 5. PRESETS / PATRONES --- */
        function loadPattern(type, name) {
            if(type === 'none') return;
            
            grid = make2DArray(cols, rows);
            generation = 0;
            population = 0;
            currentPatternName = name || type.toUpperCase();

            const cx = Math.floor(cols / 2);
            const cy = Math.floor(rows / 2);

            if (type === 'glider') {
                const points = [[0,-1], [1,0], [-1,1], [0,1], [1,1]];
                points.forEach(p => safeSet(cx+p[0], cy+p[1]));
            } 
            else if (type === 'gosper') {
                const ox = 5; const oy = 10;
                const points = [
                    [25,1], [23,2], [25,2], [13,3], [14,3], [21,3], [22,3], [35,3], [36,3], [12,4], [16,4], [21,4], [22,4], [35,4], [36,4], [1,5], [2,5], [11,5], [17,5], [21,5], [22,5], [1,6], [2,6], [11,6], [15,6], [17,6], [18,6], [23,6], [25,6], [11,7], [17,7], [25,7], [12,8], [16,8], [13,9], [14,9]
                ];
                points.forEach(p => safeSet(p[0]+ox, p[1]+oy));
            }
            else if (type === 'pulsar') {
                 const range = [-6, -1, 1, 6]; 
                 range.forEach(r => {
                     for(let c = -4; c <= 4; c++) {
                         if(Math.abs(c) !== 0 && Math.abs(c) !== 1) {
                             safeSet(cx+c, cy+r);
                             safeSet(cx+r, cy+c);
                         }
                     }
                 });
            }
            else if (type === 'lwss') {
                const p = [[0,1],[0,3],[1,0],[2,0],[3,0],[3,3],[4,0],[4,1],[4,2]];
                p.forEach(xy => safeSet(cx+xy[0], cy+xy[1]));
            }
            
            draw();
            updateStatus();
            document.getElementById('pattern-select').value = 'none'; 
        }

        function safeSet(x, y) {
            if (x >= 0 && x < cols && y >= 0 && y < rows) {
                grid[x][y] = 1;
                population++;
            }
        }

        // --- FUNCI√ìN ACTUALIZADA PARA GRID ---
        function updateStatus() {
            const t = translations[currentLang] || translations['es'];
            const patLabel = t.stat_pat || "PATR√ìN";
            
            // Si el patr√≥n es CUSTOM o RANDOM, usamos la traducci√≥n
            let displayName = currentPatternName;
            if (currentPatternName === "CUSTOM") displayName = t.pat_custom;
            if (currentPatternName === "RANDOM") displayName = t.pat_random;

            displayGen.innerText = `${t.stat_gen}: ${generation}`;
            displayPat.innerText = `${patLabel}: ${displayName}`;
            displayPop.innerText = `${t.stat_pop}: ${population}`;
        }


        /* --- 6. MULTI-IDIOMA --- */
        const translations = {
            'es': {
                nav_main: "‚Üê HUB PRINCIPAL", nav_math: "‚Üê HUB MATH",
                title: "PROYECTO AUT√ìMATA", desc: "El Juego de la Vida de Conway. Emergencia matem√°tica.",
                btn_play: "‚ñ∂ JUGAR", btn_pause: "‚è∏ PAUSA", btn_clear: "LIMPIAR", btn_random: "ALEATORIO",
                btn_color: "üé® COLOR", btn_save: "üíæ IMG",
                lbl_speed: "Velocidad:", lbl_pattern: "Cargar Patr√≥n:", opt_select: "- Seleccionar -",
                txt_note: "Haz clic o arrastra el mouse sobre la rejilla para dar vida a las c√©lulas.",
                stat_gen: "GEN", stat_pop: "POBLACI√ìN", stat_pat: "PATR√ìN",
                pat_custom: "PERSONALIZADO", pat_random: "ALEATORIO",
                h_what: "¬øQu√© es el Juego de la Vida?",
                p_what: "Dise√±ado por John Conway en 1970, es un 'juego de cero jugadores'. T√∫ determinas el estado inicial y observas c√≥mo reglas simples crean complejidad infinita.",
                h_rules: "Las 4 Reglas Sagradas",
                p_rules: "Universo de celdas vivas o muertas. Cada turno interact√∫an con sus 8 vecinas:",
                rule_1: "<strong>Soledad:</strong> < 2 vecinos ‚Üí Muere.",
                rule_2: "<strong>Supervivencia:</strong> 2 o 3 vecinos ‚Üí Vive.",
                rule_3: "<strong>Sobrepoblaci√≥n:</strong> > 3 vecinos ‚Üí Muere.",
                rule_4: "<strong>Reproducci√≥n:</strong> 3 vecinos exactos ‚Üí Nace.",
                h_math: "Significado Matem√°tico",
                p_math: "Es un ejemplo de Emergencia y es Turing Completo: puede simular cualquier algoritmo computacional.",
                legal: "Aviso Legal", privacy: "Privacidad", cookies: "Cookies", contact: "Contacto", coffee: "Inv√≠tame a un caf√©"
            },
            'en': {
                nav_main: "‚Üê MAIN HUB", nav_math: "‚Üê MATH HUB",
                title: "PROJECT AUTOMATA", desc: "Conway's Game of Life. Mathematical emergence.",
                btn_play: "‚ñ∂ PLAY", btn_pause: "‚è∏ PAUSE", btn_clear: "CLEAR", btn_random: "RANDOM",
                btn_color: "üé® COLOR", btn_save: "üíæ IMG",
                lbl_speed: "Speed:", lbl_pattern: "Load Pattern:", opt_select: "- Select -",
                txt_note: "Click or drag on the grid to bring cells to life.",
                stat_gen: "GEN", stat_pop: "POPULATION", stat_pat: "PATTERN",
                pat_custom: "CUSTOM", pat_random: "RANDOM",
                h_what: "What is the Game of Life?",
                p_what: "Designed by John Conway in 1970, it is a 'zero-player game'. You set the initial state and watch how simple rules create infinite complexity.",
                h_rules: "The 4 Sacred Rules",
                p_rules: "Universe of live or dead cells. Each turn they interact with 8 neighbors:",
                rule_1: "<strong>Underpopulation:</strong> < 2 neighbors ‚Üí Dies.",
                rule_2: "<strong>Survival:</strong> 2 or 3 neighbors ‚Üí Lives.",
                rule_3: "<strong>Overpopulation:</strong> > 3 neighbors ‚Üí Dies.",
                rule_4: "<strong>Reproduction:</strong> Exactly 3 neighbors ‚Üí Born.",
                h_math: "Mathematical Significance",
                p_math: "It is a prime example of Emergence and is Turing Complete: it can simulate any computer algorithm.",
                legal: "Legal Notice", privacy: "Privacy Policy", cookies: "Cookies", contact: "Contact", coffee: "Buy me a coffee"
            },
            'ca': {
                nav_main: "‚Üê HUB PRINCIPAL", nav_math: "‚Üê HUB MATH",
                title: "PROJECTE AUT√íMATA", desc: "El Joc de la Vida de Conway. Emerg√®ncia matem√†tica.",
                btn_play: "‚ñ∂ JUGAR", btn_pause: "‚è∏ PAUSA", btn_clear: "NETEJAR", btn_random: "ALEATORI",
                btn_color: "üé® COLOR", btn_save: "üíæ IMG",
                lbl_speed: "Velocitat:", lbl_pattern: "Carregar Patr√≥:", opt_select: "- Seleccionar -",
                txt_note: "Fes clic o arrossega el ratol√≠ sobre la graella per donar vida a les c√®l¬∑lules.",
                stat_gen: "GEN", stat_pop: "POBLACI√ì", stat_pat: "PATR√ì",
                pat_custom: "PERSONALITZAT", pat_random: "ALEATORI",
                h_what: "Qu√® √©s el Joc de la Vida?",
                p_what: "Dissenyat per John Conway el 1970, √©s un 'joc de zero jugadors'. Tu determines l'estat inicial i observes com regles simples creen complexitat infinita.",
                h_rules: "Les 4 Regles Sagrades",
                p_rules: "Univers de cel¬∑les vives o mortes. Cada torn interactuen amb les 8 ve√Ønes:",
                rule_1: "<strong>Solitud:</strong> < 2 ve√Ønes ‚Üí Mor.",
                rule_2: "<strong>Superviv√®ncia:</strong> 2 o 3 ve√Ønes ‚Üí Viu.",
                rule_3: "<strong>Sobrepoblaci√≥:</strong> > 3 ve√Ønes ‚Üí Mor.",
                rule_4: "<strong>Reproducci√≥:</strong> 3 ve√Ønes exactes ‚Üí Neix.",
                h_math: "Significat Matem√†tic",
                p_math: "√âs un exemple d'Emerg√®ncia i √©s Turing Complet: pot simular qualsevol algorisme computacional.",
                legal: "Av√≠s Legal", privacy: "Privacitat", cookies: "Cookies", contact: "Contacte", coffee: "Convida'm a un caf√®"
            },
            'fr': {
                nav_main: "‚Üê HUB PRINCIPAL", nav_math: "‚Üê HUB MATH",
                title: "PROJET AUTOMATE", desc: "Le Jeu de la Vie de Conway. √âmergence math√©matique.",
                btn_play: "‚ñ∂ JOUER", btn_pause: "‚è∏ PAUSE", btn_clear: "EFFACER", btn_random: "AL√âATOIRE",
                btn_color: "üé® COULEUR", btn_save: "üíæ IMG",
                lbl_speed: "Vitesse :", lbl_pattern: "Charger Motif :", opt_select: "- S√©lectionner -",
                txt_note: "Cliquez ou glissez sur la grille pour donner vie aux cellules.",
                stat_gen: "G√âN", stat_pop: "POPULATION", stat_pat: "MOTIF",
                pat_custom: "PERSONNALIS√â", pat_random: "AL√âATOIRE",
                h_what: "Qu'est-ce que le Jeu de la Vie ?",
                p_what: "Con√ßu par John Conway en 1970, c'est un 'jeu √† z√©ro joueur'. Vous d√©finissez l'√©tat initial et observez comment des r√®gles simples cr√©ent une complexit√© infinie.",
                h_rules: "Les 4 R√®gles Sacr√©es",
                p_rules: "Univers de cellules vivantes ou mortes. Chaque tour, elles interagissent avec 8 voisines :",
                rule_1: "<strong>Sous-population :</strong> < 2 voisines ‚Üí Meurt.",
                rule_2: "<strong>Survie :</strong> 2 ou 3 voisines ‚Üí Vit.",
                rule_3: "<strong>Surpopulation :</strong> > 3 voisines ‚Üí Meurt.",
                rule_4: "<strong>Reproduction :</strong> Exactement 3 voisines ‚Üí Na√Æt.",
                h_math: "Signification Math√©matique",
                p_math: "C'est un exemple d'√âmergence et c'est Turing-complet : il peut simuler n'importe quel algorithme.",
                legal: "Mentions L√©gales", privacy: "Confidentialit√©", cookies: "Cookies", contact: "Contact", coffee: "Offrez-moi un caf√©"
            },
            'de': {
                nav_main: "‚Üê HAUPT-HUB", nav_math: "‚Üê MATH HUB",
                title: "PROJEKT AUTOMAT", desc: "Conways Spiel des Lebens. Mathematische Emergenz.",
                btn_play: "‚ñ∂ START", btn_pause: "‚è∏ PAUSE", btn_clear: "L√ñSCHEN", btn_random: "ZUFALL",
                btn_color: "üé® FARBE", btn_save: "üíæ BILD",
                lbl_speed: "Geschw.:", lbl_pattern: "Muster laden:", opt_select: "- W√§hlen -",
                txt_note: "Klicken oder ziehen Sie auf dem Raster, um Zellen zum Leben zu erwecken.",
                stat_gen: "GEN", stat_pop: "POPULATION", stat_pat: "MUSTER",
                pat_custom: "BENUTZER", pat_random: "ZUFALL",
                h_what: "Was ist das Spiel des Lebens?",
                p_what: "Entworfen von John Conway im Jahr 1970. Du bestimmst den Anfangszustand und beobachtest, wie einfache Regeln unendliche Komplexit√§t erzeugen.",
                h_rules: "Die 4 Heiligen Regeln",
                p_rules: "Universum aus lebenden oder toten Zellen. Interaktion mit 8 Nachbarn:",
                rule_1: "<strong>Unterbev√∂lkerung:</strong> < 2 Nachbarn ‚Üí Stirbt.",
                rule_2: "<strong>√úberleben:</strong> 2 oder 3 Nachbarn ‚Üí Lebt.",
                rule_3: "<strong>√úberbev√∂lkerung:</strong> > 3 Nachbarn ‚Üí Stirbt.",
                rule_4: "<strong>Fortpflanzung:</strong> Exakt 3 Nachbarn ‚Üí Geboren.",
                h_math: "Mathematische Bedeutung",
                p_math: "Es ist ein Beispiel f√ºr Emergenz und ist Turing-vollst√§ndig: Es kann jeden Algorithmus simulieren.",
                legal: "Impressum", privacy: "Datenschutz", cookies: "Cookies", contact: "Kontakt", coffee: "Kauf mir einen Kaffee"
            },
            'pt': {
                nav_main: "‚Üê HUB PRINCIPAL", nav_math: "‚Üê HUB MATH",
                title: "PROJETO AUT√îMATO", desc: "O Jogo da Vida de Conway. Emerg√™ncia matem√°tica.",
                btn_play: "‚ñ∂ JOGAR", btn_pause: "‚è∏ PAUSA", btn_clear: "LIMPAR", btn_random: "ALEAT√ìRIO",
                btn_color: "üé® COR", btn_save: "üíæ IMG",
                lbl_speed: "Velocidade:", lbl_pattern: "Carregar Padr√£o:", opt_select: "- Selecionar -",
                txt_note: "Clique ou arraste na grade para dar vida √†s c√©lulas.",
                stat_gen: "GER", stat_pop: "POPULA√á√ÉO", stat_pat: "PADR√ÉO",
                pat_custom: "PERSONALIZADO", pat_random: "ALEAT√ìRIO",
                h_what: "O que √© o Jogo da Vida?",
                p_what: "Projetado por John Conway em 1970. Voc√™ define o estado inicial e observa como regras simples criam complexidade infinita.",
                h_rules: "As 4 Regras Sagradas",
                p_rules: "Universo de c√©lulas vivas ou mortas. A cada turno interagem com 8 vizinhas:",
                rule_1: "<strong>Subpopula√ß√£o:</strong> < 2 vizinhas ‚Üí Morre.",
                rule_2: "<strong>Sobreviv√™ncia:</strong> 2 ou 3 vizinhas ‚Üí Vive.",
                rule_3: "<strong>Superpopula√ß√£o:</strong> > 3 vizinhas ‚Üí Morre.",
                rule_4: "<strong>Reprodu√ß√£o:</strong> Exatamente 3 vizinhas ‚Üí Nasce.",
                h_math: "Significado Matem√°tico",
                p_math: "√â um exemplo de Emerg√™ncia e √© Turing Completo: pode simular qualquer algoritmo computacional.",
                legal: "Aviso Legal", privacy: "Privacidade", cookies: "Cookies", contact: "Contato", coffee: "Pagar um caf√©"
            },
            'it': {
                nav_main: "‚Üê HUB PRINCIPALE", nav_math: "‚Üê HUB MATH",
                title: "PROGETTO AUTOMA", desc: "Il Gioco della Vita di Conway. Emergenza matematica.",
                btn_play: "‚ñ∂ GIOCA", btn_pause: "‚è∏ PAUSA", btn_clear: "PULISCI", btn_random: "CASUALE",
                btn_color: "üé® COLORE", btn_save: "üíæ IMG",
                lbl_speed: "Velocit√†:", lbl_pattern: "Carica Pattern:", opt_select: "- Seleziona -",
                txt_note: "Clicca o trascina sulla griglia per dare vita alle cellule.",
                stat_gen: "GEN", stat_pop: "POPOLAZIONE", stat_pat: "PATTERN",
                pat_custom: "PERSONALIZZATO", pat_random: "CASUALE",
                h_what: "Cos'√® il Gioco della Vita?",
                p_what: "Progettato da John Conway nel 1970. Tu determini lo stato iniziale e osservi come regole semplici creano complessit√† infinita.",
                h_rules: "Le 4 Regole Sacre",
                p_rules: "Universo di cellule vive o morte. Ogni turno interagiscono con 8 vicine:",
                rule_1: "<strong>Sottopopolazione:</strong> < 2 vicine ‚Üí Muore.",
                rule_2: "<strong>Sopravvivenza:</strong> 2 o 3 vicine ‚Üí Vive.",
                rule_3: "<strong>Sovrappopolazione:</strong> > 3 vicine ‚Üí Muore.",
                rule_4: "<strong>Riproduzione:</strong> Esattamente 3 vicine ‚Üí Nasce.",
                h_math: "Significato Matematico",
                p_math: "√à un esempio di Emergenza ed √® Turing Completo: pu√≤ simulare qualsiasi algoritmo.",
                legal: "Note Legali", privacy: "Privacy", cookies: "Cookies", contact: "Contatto", coffee: "Offrimi un caff√®"
            },
            'nl': {
                nav_main: "‚Üê HOOFDHUB", nav_math: "‚Üê MATH HUB",
                title: "PROJECT AUTOMAAT", desc: "Conway's Game of Life. Wiskundige emergentie.",
                btn_play: "‚ñ∂ START", btn_pause: "‚è∏ PAUZE", btn_clear: "WISSEN", btn_random: "WILLEKEURIG",
                btn_color: "üé® KLEUR", btn_save: "üíæ IMG",
                lbl_speed: "Snelheid:", lbl_pattern: "Patroon Laden:", opt_select: "- Selecteer -",
                txt_note: "Klik of sleep op het rooster om cellen tot leven te wekken.",
                stat_gen: "GEN", stat_pop: "BEVOLKING", stat_pat: "PATROON",
                pat_custom: "AANGEPAST", pat_random: "WILLEKEURIG",
                h_what: "Wat is de Game of Life?",
                p_what: "Ontworpen door John Conway in 1970. Je bepaalt de beginstatus en ziet hoe eenvoudige regels oneindige complexiteit cre√´ren.",
                h_rules: "De 4 Heilige Regels",
                p_rules: "Universum van levende of dode cellen. Interactie met 8 buren:",
                rule_1: "<strong>Onderbevolking:</strong> < 2 buren ‚Üí Sterft.",
                rule_2: "<strong>Overleving:</strong> 2 of 3 buren ‚Üí Leeft.",
                rule_3: "<strong>Overbevolking:</strong> > 3 buren ‚Üí Sterft.",
                rule_4: "<strong>Voortplanting:</strong> Precies 3 buren ‚Üí Geboren.",
                h_math: "Wiskundige Betekenis",
                p_math: "Het is een voorbeeld van Emergentie en is Turing Compleet: het kan elk algoritme simuleren.",
                legal: "Juridisch", privacy: "Privacy", cookies: "Cookies", contact: "Contact", coffee: "Koop koffie"
            },
            'ja': {
                nav_main: "‚Üê „É°„Ç§„É≥„Éè„Éñ", nav_math: "‚Üê Êï∞Â≠¶„Éè„Éñ",
                title: "„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Éª„Ç™„Éº„Éà„Éû„Éà„É≥", desc: "„Ç≥„É≥„Ç¶„Çß„Ç§„ÅÆ„É©„Ç§„Éï„Ç≤„Éº„É†„ÄÇÊï∞Â≠¶ÁöÑÂâµÁô∫„ÄÇ",
                btn_play: "‚ñ∂ ÂÜçÁîü", btn_pause: "‚è∏ ‰∏ÄÊôÇÂÅúÊ≠¢", btn_clear: "„ÇØ„É™„Ç¢", btn_random: "„É©„É≥„ÉÄ„É†",
                btn_color: "üé® Ëâ≤", btn_save: "üíæ ÁîªÂÉè",
                lbl_speed: "ÈÄüÂ∫¶:", lbl_pattern: "„Éë„Çø„Éº„É≥Ë™≠Ëæº:", opt_select: "- ÈÅ∏Êäû -",
                txt_note: "„Ç∞„É™„ÉÉ„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØ„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶Á¥∞ËÉû„Å´ÂëΩ„ÇíÂêπ„ÅçËæº„Åø„Åæ„Åô„ÄÇ",
                stat_gen: "‰∏ñ‰ª£", stat_pop: "‰∫∫Âè£", stat_pat: "„Éë„Çø„Éº„É≥",
                pat_custom: "„Ç´„Çπ„Çø„É†", pat_random: "„É©„É≥„ÉÄ„É†",
                h_what: "„É©„Ç§„Éï„Ç≤„Éº„É†„Å®„ÅØÔºü",
                p_what: "1970Âπ¥„Å´„Ç∏„Éß„É≥„Éª„Ç≥„É≥„Ç¶„Çß„Ç§„Å´„Çà„Å£„Å¶Ë®≠Ë®à„Åï„Çå„Åæ„Åó„Åü„ÄÇÂàùÊúüÁä∂ÊÖã„ÇíÊ±∫ÂÆö„Åó„ÄÅÂçòÁ¥î„Å™„É´„Éº„É´„ÅåÁÑ°Èôê„ÅÆË§áÈõë„Åï„ÇíÁîü„ÅøÂá∫„ÅôÊßòÂ≠ê„ÇíË¶≥ÂØü„Åó„Åæ„Åô„ÄÇ",
                h_rules: "4„Å§„ÅÆËÅñ„Å™„Çã„É´„Éº„É´",
                p_rules: "Áîü„Åç„Å¶„ÅÑ„Çã„Åæ„Åü„ÅØÊ≠ª„Çì„Åß„ÅÑ„ÇãÁ¥∞ËÉû„ÅÆÂÆáÂÆô„ÄÇÂêÑ„Çø„Éº„É≥„Åß8„Å§„ÅÆÈö£‰∫∫„Å®Áõ∏‰∫í‰ΩúÁî®„Åó„Åæ„ÅôÔºö",
                rule_1: "<strong>ÈÅéÁñé:</strong> Èö£‰∫∫„Åå2„Å§Êú™Ê∫Ä ‚Üí Ê≠ª„Å¨„ÄÇ",
                rule_2: "<strong>ÁîüÂ≠ò:</strong> Èö£‰∫∫„Åå2„Å§„Åã3„Å§ ‚Üí Áîü„Åç„Çã„ÄÇ",
                rule_3: "<strong>ÈÅéÂØÜ:</strong> Èö£‰∫∫„Åå3„Å§Ë∂Ö ‚Üí Ê≠ª„Å¨„ÄÇ",
                rule_4: "<strong>Ë™ïÁîü:</strong> Èö£‰∫∫„Åå„Å°„Çá„ÅÜ„Å©3„Å§ ‚Üí Áîü„Åæ„Çå„Çã„ÄÇ",
                h_math: "Êï∞Â≠¶ÁöÑÊÑèÁæ©",
                p_math: "„Åì„Çå„ÅØÂâµÁô∫„ÅÆ‰æã„Åß„ÅÇ„Çä„ÄÅ„ÉÅ„É•„Éº„É™„É≥„Ç∞ÂÆåÂÖ®„Åß„Åô„ÄÇ„Å§„Åæ„Çä„ÄÅ„ÅÇ„Çâ„ÇÜ„ÇãË®àÁÆó„Ç¢„É´„Ç¥„É™„Ç∫„É†„Çí„Ç∑„Éü„É•„É¨„Éº„Éà„Åß„Åç„Åæ„Åô„ÄÇ",
                legal: "Ê≥ïÁöÑÈÄöÁü•", privacy: "„Éó„É©„Ç§„Éê„Ç∑„Éº", cookies: "„ÇØ„ÉÉ„Ç≠„Éº", contact: "ÈÄ£Áµ°ÂÖà", coffee: "„Ç≥„Éº„Éí„Éº„ÇíÂ•¢„Çã"
            }
        };

        // INIT LANG
        const savedLang = localStorage.getItem('gl_lang') || 'es';
        let currentLang = savedLang;
        
        function setLang(lang) {
            localStorage.setItem('gl_lang', lang);
            currentLang = lang;
            const t = translations[lang] || translations['es'];
            
            document.getElementById('nav-main').innerText = t.nav_main;
            document.getElementById('nav-math').innerText = t.nav_math;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-desc').innerText = t.desc;
            
            document.getElementById('btn-play').innerText = isPlaying ? t.btn_pause : t.btn_play;
            document.getElementById('btn-clear').innerText = t.btn_clear;
            document.getElementById('btn-random').innerText = t.btn_random;
            document.getElementById('btn-color').innerText = t.btn_color;
            document.getElementById('btn-save').innerText = t.btn_save;
            
            document.getElementById('lbl-speed').innerText = t.lbl_speed;
            document.getElementById('lbl-pattern').innerText = t.lbl_pattern;
            document.getElementById('opt-select').innerText = t.opt_select;
            document.getElementById('txt-note').innerText = t.txt_note;

            document.getElementById('info-h-what').innerText = t.h_what;
            document.getElementById('info-p-what').innerText = t.p_what;
            document.getElementById('info-h-rules').innerText = t.h_rules;
            document.getElementById('info-p-rules').innerText = t.p_rules;
            
            document.getElementById('rule-1').innerHTML = t.rule_1;
            document.getElementById('rule-2').innerHTML = t.rule_2;
            document.getElementById('rule-3').innerHTML = t.rule_3;
            document.getElementById('rule-4').innerHTML = t.rule_4;
            
            document.getElementById('info-h-math').innerText = t.h_math;
            document.getElementById('info-p-math').innerText = t.p_math;

            document.getElementById('link-legal').innerText = t.legal;
            document.getElementById('link-privacy').innerText = t.privacy;
            document.getElementById('link-cookies').innerText = t.cookies;
            document.getElementById('link-contact').innerText = t.contact;
            document.getElementById('btn-coffee').innerText = t.coffee;

            document.querySelectorAll('.lang-switch button').forEach(b => {
                b.classList.remove('active');
                if(b.id === 'btn-' + lang) b.classList.add('active');
            });

            updateStatus(); 
        }

        /* --- 7. BACKGROUND ANIMATION --- */
        const bgCanvas = document.getElementById('bg-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        let particlesArray = [];
        
        function resizeBg() { bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight; }
        window.addEventListener('resize', () => { resizeBg(); resizeCanvas(); }); // Resize both
        resizeBg(); resizeCanvas();

        class Particle {
            constructor() {
                this.x = Math.random() * bgCanvas.width;
                this.y = Math.random() * bgCanvas.height;
                this.size = Math.random() * 10 + 5;
                this.speedX = (Math.random() * 0.5) - 0.25;
                this.speedY = (Math.random() * 0.5) - 0.25;
                const symbols = ['0', '1'];
                this.text = symbols[Math.floor(Math.random() * symbols.length)];
            }
            update() {
                this.x += this.speedX; this.y += this.speedY;
                if (this.x > bgCanvas.width) this.x = 0; else if (this.x < 0) this.x = bgCanvas.width;
                if (this.y > bgCanvas.height) this.y = 0; else if (this.y < 0) this.y = bgCanvas.height;
                
                bgCtx.font = this.size + 'px monospace';
                bgCtx.fillStyle = 'rgba(0, 255, 65, 0.1)'; 
                bgCtx.fillText(this.text, this.x, this.y);
            }
        }
        function initParticles() {
            particlesArray = [];
            let n = (bgCanvas.height * bgCanvas.width) / 10000;
            for (let i = 0; i < n; i++) particlesArray.push(new Particle());
        }
        function animateParticles() {
            bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
            for (let i = 0; i < particlesArray.length; i++) particlesArray[i].update();
            requestAnimationFrame(animateParticles);
        }
        
        initParticles(); animateParticles();
        setLang(savedLang);

    </script>
</body>
</html>
